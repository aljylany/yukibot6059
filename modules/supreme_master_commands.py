"""
ุฃูุงูุฑ ุงูุณูุฏ ุงูุฃุนูู ุงูุฎุงุตุฉ
Supreme Master Special Commands
"""

import logging
from aiogram import Router, F
from aiogram.types import Message
from config.hierarchy import is_supreme_master

# Router ููุฃูุงูุฑ ุงูุฎุงุตุฉ
router = Router()

# ูุชุบูุฑ ุนุงู ูุญุงูุฉ ุชูุนูู ุงูุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ
MASTERS_PUNISHMENT_ENABLED = False

def get_masters_punishment_status() -> bool:
    """ุงูุญุตูู ุนูู ุญุงูุฉ ุชูุนูู ุงูุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ"""
    return MASTERS_PUNISHMENT_ENABLED

def set_masters_punishment_status(enabled: bool) -> None:
    """ุชุนููู ุญุงูุฉ ุชูุนูู ุงูุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ"""
    global MASTERS_PUNISHMENT_ENABLED
    MASTERS_PUNISHMENT_ENABLED = enabled
    logging.info(f"๐ง ุชู {'ุชูุนูู' if enabled else 'ุชุนุทูู'} ูุธุงู ุงูุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ")

@router.message(F.text.in_(["ุชูุนูู ุนููุจุงุช ุงูุงุณูุงุฏ", "ุชูุนูู ุงูุนููุจุงุช", "ุชูุนูู ุงูุนููุจุฉ", "ุชูุนูู ุงูุนููุฏ", "ุชูุนูู_ุนููุจุงุช_ุงูุงุณูุงุฏ", "ุชูุนูู ุงูุนููุจู", "ุชูุนูู ุนููุจุฉ ุงูุงุณูุงุฏ"]))
async def enable_masters_punishment(message: Message):
    """ุชูุนูู ูุธุงู ุงูุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ ุงูุขุฎุฑูู"""
    try:
        # ุงูุชุญูู ูู ุฃู ุงููุฑุณู ูู ุงูุณูุฏ ุงูุฃุนูู ููุท
        if not message.from_user or not is_supreme_master(message.from_user.id):
            await message.reply("โ ูุฐุง ุงูุฃูุฑ ูุชุงุญ ููุณูุฏ ุงูุฃุนูู ููุท")
            return
        
        # ุชูุนูู ูุธุงู ุงูุนููุจุงุช
        set_masters_punishment_status(True)
        
        response = (
            "๐ฅ **ุชู ุชูุนูู ูุธุงู ุงูุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ**\n\n"
            "โ๏ธ **ุชุญุฐูุฑ ูุงู:**\n"
            "โข ุงูุฃุณูุงุฏ ุงูุขุฎุฑูู ุณููุนุงูููู ูุฃุนุถุงุก ุนุงุฏููู\n"
            "โข ุณูุชู ุชุทุจูู ุงูุนููุจุงุช ุงููุงููุฉ ุนูููู (ูุชูุ ุจุงูุ ุฅูุฎ)\n"
            "โข ุฃูุช (ุงูุณูุฏ ุงูุฃุนูู) ูุญูู ุฏุงุฆูุงู\n\n"
            "๐๏ธ **ููุฅูุบุงุก:** ุงุณุชุฎุฏู ุงูุฃูุฑ `ุงูุบุงุก ุงูุนููุจุงุช`\n\n"
            "๐ **ุงูุณูุฏ ุงูุฃุนูู:** ุฃูุช ุงููุญูุฏ ุงููุญูู ูู ุฌููุน ุงูุฃูุธูุฉ"
        )
        
        await message.reply(response, parse_mode="Markdown")
        logging.warning(f"๐ ุงูุณูุฏ ุงูุฃุนูู {message.from_user.id} ูุนู ูุธุงู ุงูุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ")
        
    except Exception as e:
        logging.error(f"ุฎุทุฃ ูู ุชูุนูู ุนููุจุงุช ุงูุฃุณูุงุฏ: {e}")
        await message.reply("โ ุญุฏุซ ุฎุทุฃ ูู ุชูุนูู ุงููุธุงู")

@router.message(F.text.in_(["ุงูุบุงุก ุนููุจุงุช ุงูุงุณูุงุฏ", "ุงูุบุงุก ุงูุนููุจุงุช", "ุชุนุทูู ุงูุนููุจุงุช", "ุงูุบุงุก_ุนููุจุงุช_ุงูุงุณูุงุฏ"]))
async def disable_masters_punishment(message: Message):
    """ุฅูุบุงุก ุชูุนูู ูุธุงู ุงูุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ"""
    try:
        # ุงูุชุญูู ูู ุฃู ุงููุฑุณู ูู ุงูุณูุฏ ุงูุฃุนูู ููุท
        if not message.from_user or not is_supreme_master(message.from_user.id):
            await message.reply("โ ูุฐุง ุงูุฃูุฑ ูุชุงุญ ููุณูุฏ ุงูุฃุนูู ููุท")
            return
        
        # ุฅูุบุงุก ุชูุนูู ูุธุงู ุงูุนููุจุงุช
        set_masters_punishment_status(False)
        
        response = (
            "โ **ุชู ุฅูุบุงุก ูุธุงู ุงูุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ**\n\n"
            "๐ก๏ธ **ุงููุถุน ุงูุญุงูู:**\n"
            "โข ุงูุฃุณูุงุฏ ุนุงุฏูุง ููุญูุงูุฉ ุงููุงููุฉ\n"
            "โข ูุง ุชูุฌุฏ ุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ ุงูุขุฎุฑูู\n"
            "โข ุงููุธุงู ูุนูู ูู ุงููุถุน ุงูุนุงุฏู\n\n"
            "๐ **ุฃูุช ูุญูู ุฏุงุฆูุงู** ูุงูุณูุฏ ุงูุฃุนูู"
        )
        
        await message.reply(response, parse_mode="Markdown")
        logging.warning(f"๐ ุงูุณูุฏ ุงูุฃุนูู {message.from_user.id} ุฃูุบู ูุธุงู ุงูุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ")
        
    except Exception as e:
        logging.error(f"ุฎุทุฃ ูู ุฅูุบุงุก ุนููุจุงุช ุงูุฃุณูุงุฏ: {e}")
        await message.reply("โ ุญุฏุซ ุฎุทุฃ ูู ุฅูุบุงุก ุงููุธุงู")

@router.message(F.text.in_(["ุญุงูุฉ ุงูุงุณูุงุฏ", "ุญุงูุฉ ุงูุนููุจุงุช", "ูุถุน ุงูุงุณูุงุฏ", "ุญุงูุฉ_ุงูุงุณูุงุฏ"]))
async def check_masters_status(message: Message):
    """ูุญุต ุญุงูุฉ ูุธุงู ุงูุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ"""
    try:
        # ุงูุชุญูู ูู ุฃู ุงููุฑุณู ูู ุงูุณูุฏ ุงูุฃุนูู ููุท
        if not message.from_user or not is_supreme_master(message.from_user.id):
            await message.reply("โ ูุฐุง ุงูุฃูุฑ ูุชุงุญ ููุณูุฏ ุงูุฃุนูู ููุท")
            return
        
        current_status = get_masters_punishment_status()
        
        if current_status:
            response = (
                "๐ฅ **ูุธุงู ุงูุนููุจุงุช ูููุนู**\n\n"
                "โ๏ธ **ุงููุถุน ุงูุญุงูู:**\n"
                "โข ุงูุฃุณูุงุฏ ุงูุขุฎุฑูู ููุนุงูููู ูุฃุนุถุงุก ุนุงุฏููู\n"
                "โข ุงูุนููุจุงุช ูููุนูุฉ ุนูููู (ูุชูุ ุจุงูุ ุฅูุฎ)\n"
                "โข ุงูุณูุฏ ุงูุฃุนูู ูุญูู ุฏุงุฆูุงู\n\n"
                "๐ ููุฅูุบุงุก: `ุงูุบุงุก ุงูุนููุจุงุช`"
            )
        else:
            response = (
                "๐ก๏ธ **ูุธุงู ุงูุนููุจุงุช ุบูุฑ ูููุนู**\n\n"
                "โ **ุงููุถุน ุงูุญุงูู:**\n"
                "โข ุงูุฃุณูุงุฏ ูุญูููู ูู ุฌููุน ุงูุนููุจุงุช\n"
                "๐ฅ ููุชูุนูู: `ุชูุนูู ุงูุนููุจุงุช`"
            )
        
        await message.reply(response, parse_mode="Markdown")
        
    except Exception as e:
        logging.error(f"ุฎุทุฃ ูู ูุญุต ุญุงูุฉ ุงูุฃุณูุงุฏ: {e}")
        await message.reply("โ ุญุฏุซ ุฎุทุฃ ูู ูุญุต ุงูุญุงูุฉ")

# ุฅุถุงูุฉ ุฃูุฑ ููุฑุงุกุฉ ููู ุงูุฃูุงูุฑ
@router.message(F.text.in_(["ุงูุงูุฑ ุงููุธุงู ุงูุฌุฏูุฏ", "ุฃูุงูุฑ ุงููุธุงู ุงูุฌุฏูุฏ", "ุงูุงูุงูุฑ ุงูุฌุฏูุฏุฉ", "ุงูุฃูุงูุฑ ุงูุฌุฏูุฏุฉ"]))
async def show_new_system_commands(message: Message):
    """ุนุฑุถ ุฃูุงูุฑ ุงููุธุงู ุงูุฌุฏูุฏ ููุณูุฏ ุงูุฃุนูู"""
    try:
        if not message.from_user or not is_supreme_master(message.from_user.id):
            await message.reply("โ ูุฐุง ุงูุฃูุฑ ูุชุงุญ ููุณูุฏ ุงูุฃุนูู ููุท")
            return
        
        new_commands_info = (
            "๐ **ุฃูุงูุฑ ุงููุธุงู ุงูุฌุฏูุฏ - ุงูุณูุฏ ุงูุฃุนูู ููุท**\n\n"
            "๐ง **ุงูุชุญูู ูู ุนููุจุงุช ุงูุฃุณูุงุฏ:**\n"
            "โข `ุชูุนูู ุงูุนููุจุงุช` - ุชูุนูู ุงูุนููุจุงุช ุนูู ุงูุฃุณูุงุฏ ุงูุขุฎุฑูู\n"
            "โข `ุงูุบุงุก ุงูุนููุจุงุช` - ุฅูุบุงุก ุงูุนููุจุงุช ูุฅุฑุฌุงุน ุงูุญูุงูุฉ\n"
            "โข `ุญุงูุฉ ุงูุนููุจุงุช` - ูุญุต ุงูุญุงูุฉ ุงูุญุงููุฉ\n"
            "โข `ูุถุน ุงูุงุณูุงุฏ` - ุนุฑุถ ูุถุน ุงูุฃุณูุงุฏ\n\n"
            "๐ **ุงูุฃูุงูุฑ ุงูุจุฏููุฉ:**\n"
            "โข `ุชูุนูู ุนููุจุงุช ุงูุงุณูุงุฏ`\n"
            "โข `ุงูุบุงุก ุนููุจุงุช ุงูุงุณูุงุฏ`\n"
            "โข `ุชุนุทูู ุงูุนููุจุงุช`\n"
            "โข `ุญุงูุฉ ุงูุงุณูุงุฏ`\n\n"
            "โ๏ธ **ุชุญุฐูุฑ:** ุนูุฏ ุชูุนูู ุงูุนููุจุงุชุ ุงูุฃุณูุงุฏ ุงูุขุฎุฑูู ุณููุนุงูููู ูุฃุนุถุงุก ุนุงุฏููู!\n"
            "๐ **ุฃูุช ูุญูู ุฏุงุฆูุงู** ูุงูุณูุฏ ุงูุฃุนูู ูู ุฌููุน ุงูุฃูุธูุฉ"
        )
        
        await message.reply(new_commands_info, parse_mode="Markdown")
        
    except Exception as e:
        logging.error(f"ุฎุทุฃ ูู ุนุฑุถ ุฃูุงูุฑ ุงููุธุงู ุงูุฌุฏูุฏ: {e}")
        await message.reply("โ ุญุฏุซ ุฎุทุฃ ูู ุนุฑุถ ุงูุฃูุงูุฑ")